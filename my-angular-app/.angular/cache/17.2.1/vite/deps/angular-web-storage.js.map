{
  "version": 3,
  "sources": ["../../../../../node_modules/angular-web-storage/fesm2022/angular-web-storage.mjs"],
  "sourcesContent": ["import * as i0 from '@angular/core';\nimport { Injectable } from '@angular/core';\n\n/**\n * 判断是否在浏览器中渲染Angular应用\n * `decorator` 无法直接使用Angular `PLATFORM_ID` 标识\n * 这带来的好处是当服务端自行填充 Document 时也能很好的识别\n */\nconst isBrowser = typeof document === 'object' && !!document;\nclass StorageUtil {\n  static get(storage, key) {\n    if (storage == null) {\n      return null;\n    }\n    const value = StorageUtil.parse(storage.getItem(key) || 'null') || null;\n    if (value === null) {\n      return null;\n    }\n    if (typeof value === 'object' && typeof value._expired !== 'undefined' && value._expired !== 0 && +new Date() > value._expired) {\n      StorageUtil.remove(storage, key);\n      return null;\n    }\n    return value._value || null;\n  }\n  static set(storage, key, value, expiredAt = 0, expiredUnit = 't') {\n    if (storage == null) {\n      return;\n    }\n    storage.setItem(key, StorageUtil.stringify({\n      _expired: StorageUtil.getExpired(expiredAt, expiredUnit),\n      _value: value\n    }));\n  }\n  static remove(storage, key) {\n    if (storage == null) {\n      return;\n    }\n    storage.removeItem(key);\n  }\n  static key(storage, index) {\n    if (storage == null) {\n      return null;\n    }\n    return storage.key(index);\n  }\n  static getExpired(val, unit) {\n    if (val <= 0) {\n      return 0;\n    }\n    const now = +new Date();\n    switch (unit) {\n      case 's':\n        // 秒\n        return now + 1000 * val;\n      case 'm':\n        // 分\n        return now + 1000 * 60 * val;\n      case 'h':\n        // 时\n        return now + 1000 * 60 * 60 * val;\n      case 'd':\n        // 天\n        return now + 1000 * 60 * 60 * 24 * val;\n      case 'w':\n        // 周\n        return now + 1000 * 60 * 60 * 24 * 7 * val;\n      case 'y':\n        // 年\n        return now + 1000 * 60 * 60 * 24 * 365 * val;\n      case 't':\n        // 自定义\n        return now + val;\n      default:\n        return 0;\n    }\n  }\n  static stringify(value) {\n    return JSON.stringify(value);\n  }\n  static parse(text) {\n    try {\n      return JSON.parse(text) || null;\n    } catch (e) {\n      return text;\n    }\n  }\n}\nconst cache = {};\nfunction WebStorage(storage, key, expiredAt = 0, expiredUnit = 'd') {\n  return (target, propertyName) => {\n    key = key || propertyName;\n    Object.defineProperty(target, propertyName, {\n      get: () => {\n        return StorageUtil.get(storage, key);\n      },\n      set: value => {\n        if (!cache[key]) {\n          const storedValue = StorageUtil.get(storage, key);\n          if (storedValue === null) {\n            StorageUtil.set(storage, key, value, expiredAt, expiredUnit);\n          }\n          cache[key] = true;\n          return;\n        }\n        StorageUtil.set(storage, key, value, expiredAt, expiredUnit);\n      },\n      enumerable: true,\n      configurable: true\n    });\n  };\n}\n/**\n * `localStorage` Decorator\n *\n * @param [expiredAt=0] Expiration time, 0 means forever\n * @param [expiredUnit='t'] Expiration time unit (default: custom [unit: ms])\n */\nfunction LocalStorage(key, expiredAt = 0, expiredUnit = 't') {\n  return WebStorage(isBrowser ? localStorage : null, key, expiredAt, expiredUnit);\n}\n/**\n * `sessionStorage` Decorator\n *\n * @param [expiredAt=0] Expiration time, 0 means forever\n * @param [expiredUnit='t'] Expiration time unit (default: custom [unit: ms])\n */\nfunction SessionStorage(key, expiredAt = 0, expiredUnit = 't') {\n  return WebStorage(isBrowser ? sessionStorage : null, key, expiredAt, expiredUnit);\n}\nclass StorageService {\n  constructor(storage) {\n    this.storage = storage;\n  }\n  get(key) {\n    return StorageUtil.get(this.storage, key);\n  }\n  set(key, value, expiredAt = 0, expiredUnit = 'd') {\n    return StorageUtil.set(this.storage, key, value, expiredAt, expiredUnit);\n  }\n  /**\n   * 删除指定key，如：\n   * - `remove('key')` 删除 `key` 键\n   * - `remove(/BMap_\\w+/)` 批量删除所有 BMap_ 开头的键\n   * @param key 键名或正则表达式\n   */\n  remove(key) {\n    if (typeof key === 'string') {\n      StorageUtil.remove(this.storage, key);\n      return;\n    }\n    let index = 0;\n    let next = StorageUtil.key(this.storage, index);\n    const ls = [];\n    while (next) {\n      if (key.test(next)) {\n        ls.push(next);\n      }\n      next = StorageUtil.key(this.storage, ++index);\n    }\n    ls.forEach(v => StorageUtil.remove(this.storage, v));\n  }\n  clear() {\n    this.storage?.clear();\n  }\n  static {\n    this.ɵfac = function StorageService_Factory(t) {\n      return new (t || StorageService)(i0.ɵɵinject(Storage));\n    };\n  }\n  static {\n    this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n      token: StorageService,\n      factory: StorageService.ɵfac\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(StorageService, [{\n    type: Injectable\n  }], () => [{\n    type: Storage\n  }], null);\n})();\nclass LocalStorageService extends StorageService {\n  constructor() {\n    super(isBrowser ? localStorage : null);\n  }\n  static {\n    this.ɵfac = function LocalStorageService_Factory(t) {\n      return new (t || LocalStorageService)();\n    };\n  }\n  static {\n    this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n      token: LocalStorageService,\n      factory: LocalStorageService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(LocalStorageService, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], () => [], null);\n})();\nclass SessionStorageService extends StorageService {\n  constructor() {\n    super(isBrowser ? sessionStorage : null);\n  }\n  static {\n    this.ɵfac = function SessionStorageService_Factory(t) {\n      return new (t || SessionStorageService)();\n    };\n  }\n  static {\n    this.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n      token: SessionStorageService,\n      factory: SessionStorageService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(SessionStorageService, [{\n    type: Injectable,\n    args: [{\n      providedIn: 'root'\n    }]\n  }], () => [], null);\n})();\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { LocalStorage, LocalStorageService, SessionStorage, SessionStorageService, StorageService, StorageUtil, isBrowser };\n"],
  "mappings": ";;;;;;;;;;;AAQA,IAAM,YAAY,OAAO,aAAa,YAAY,CAAC,CAAC;AACpD,IAAM,cAAN,MAAM,aAAY;AAAA,EAChB,OAAO,IAAI,SAAS,KAAK;AACvB,QAAI,WAAW,MAAM;AACnB,aAAO;AAAA,IACT;AACA,UAAM,QAAQ,aAAY,MAAM,QAAQ,QAAQ,GAAG,KAAK,MAAM,KAAK;AACnE,QAAI,UAAU,MAAM;AAClB,aAAO;AAAA,IACT;AACA,QAAI,OAAO,UAAU,YAAY,OAAO,MAAM,aAAa,eAAe,MAAM,aAAa,KAAK,CAAC,oBAAI,KAAK,IAAI,MAAM,UAAU;AAC9H,mBAAY,OAAO,SAAS,GAAG;AAC/B,aAAO;AAAA,IACT;AACA,WAAO,MAAM,UAAU;AAAA,EACzB;AAAA,EACA,OAAO,IAAI,SAAS,KAAK,OAAO,YAAY,GAAG,cAAc,KAAK;AAChE,QAAI,WAAW,MAAM;AACnB;AAAA,IACF;AACA,YAAQ,QAAQ,KAAK,aAAY,UAAU;AAAA,MACzC,UAAU,aAAY,WAAW,WAAW,WAAW;AAAA,MACvD,QAAQ;AAAA,IACV,CAAC,CAAC;AAAA,EACJ;AAAA,EACA,OAAO,OAAO,SAAS,KAAK;AAC1B,QAAI,WAAW,MAAM;AACnB;AAAA,IACF;AACA,YAAQ,WAAW,GAAG;AAAA,EACxB;AAAA,EACA,OAAO,IAAI,SAAS,OAAO;AACzB,QAAI,WAAW,MAAM;AACnB,aAAO;AAAA,IACT;AACA,WAAO,QAAQ,IAAI,KAAK;AAAA,EAC1B;AAAA,EACA,OAAO,WAAW,KAAK,MAAM;AAC3B,QAAI,OAAO,GAAG;AACZ,aAAO;AAAA,IACT;AACA,UAAM,MAAM,CAAC,oBAAI,KAAK;AACtB,YAAQ,MAAM;AAAA,MACZ,KAAK;AAEH,eAAO,MAAM,MAAO;AAAA,MACtB,KAAK;AAEH,eAAO,MAAM,MAAO,KAAK;AAAA,MAC3B,KAAK;AAEH,eAAO,MAAM,MAAO,KAAK,KAAK;AAAA,MAChC,KAAK;AAEH,eAAO,MAAM,MAAO,KAAK,KAAK,KAAK;AAAA,MACrC,KAAK;AAEH,eAAO,MAAM,MAAO,KAAK,KAAK,KAAK,IAAI;AAAA,MACzC,KAAK;AAEH,eAAO,MAAM,MAAO,KAAK,KAAK,KAAK,MAAM;AAAA,MAC3C,KAAK;AAEH,eAAO,MAAM;AAAA,MACf;AACE,eAAO;AAAA,IACX;AAAA,EACF;AAAA,EACA,OAAO,UAAU,OAAO;AACtB,WAAO,KAAK,UAAU,KAAK;AAAA,EAC7B;AAAA,EACA,OAAO,MAAM,MAAM;AACjB,QAAI;AACF,aAAO,KAAK,MAAM,IAAI,KAAK;AAAA,IAC7B,SAAS,GAAG;AACV,aAAO;AAAA,IACT;AAAA,EACF;AACF;AACA,IAAM,QAAQ,CAAC;AACf,SAAS,WAAW,SAAS,KAAK,YAAY,GAAG,cAAc,KAAK;AAClE,SAAO,CAAC,QAAQ,iBAAiB;AAC/B,UAAM,OAAO;AACb,WAAO,eAAe,QAAQ,cAAc;AAAA,MAC1C,KAAK,MAAM;AACT,eAAO,YAAY,IAAI,SAAS,GAAG;AAAA,MACrC;AAAA,MACA,KAAK,WAAS;AACZ,YAAI,CAAC,MAAM,GAAG,GAAG;AACf,gBAAM,cAAc,YAAY,IAAI,SAAS,GAAG;AAChD,cAAI,gBAAgB,MAAM;AACxB,wBAAY,IAAI,SAAS,KAAK,OAAO,WAAW,WAAW;AAAA,UAC7D;AACA,gBAAM,GAAG,IAAI;AACb;AAAA,QACF;AACA,oBAAY,IAAI,SAAS,KAAK,OAAO,WAAW,WAAW;AAAA,MAC7D;AAAA,MACA,YAAY;AAAA,MACZ,cAAc;AAAA,IAChB,CAAC;AAAA,EACH;AACF;AAOA,SAAS,aAAa,KAAK,YAAY,GAAG,cAAc,KAAK;AAC3D,SAAO,WAAW,YAAY,eAAe,MAAM,KAAK,WAAW,WAAW;AAChF;AAOA,SAAS,eAAe,KAAK,YAAY,GAAG,cAAc,KAAK;AAC7D,SAAO,WAAW,YAAY,iBAAiB,MAAM,KAAK,WAAW,WAAW;AAClF;AACA,IAAM,kBAAN,MAAM,gBAAe;AAAA,EACnB,YAAY,SAAS;AACnB,SAAK,UAAU;AAAA,EACjB;AAAA,EACA,IAAI,KAAK;AACP,WAAO,YAAY,IAAI,KAAK,SAAS,GAAG;AAAA,EAC1C;AAAA,EACA,IAAI,KAAK,OAAO,YAAY,GAAG,cAAc,KAAK;AAChD,WAAO,YAAY,IAAI,KAAK,SAAS,KAAK,OAAO,WAAW,WAAW;AAAA,EACzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,OAAO,KAAK;AACV,QAAI,OAAO,QAAQ,UAAU;AAC3B,kBAAY,OAAO,KAAK,SAAS,GAAG;AACpC;AAAA,IACF;AACA,QAAI,QAAQ;AACZ,QAAI,OAAO,YAAY,IAAI,KAAK,SAAS,KAAK;AAC9C,UAAM,KAAK,CAAC;AACZ,WAAO,MAAM;AACX,UAAI,IAAI,KAAK,IAAI,GAAG;AAClB,WAAG,KAAK,IAAI;AAAA,MACd;AACA,aAAO,YAAY,IAAI,KAAK,SAAS,EAAE,KAAK;AAAA,IAC9C;AACA,OAAG,QAAQ,OAAK,YAAY,OAAO,KAAK,SAAS,CAAC,CAAC;AAAA,EACrD;AAAA,EACA,QAAQ;AACN,SAAK,SAAS,MAAM;AAAA,EACtB;AAYF;AAVI,gBAAK,OAAO,SAAS,uBAAuB,GAAG;AAC7C,SAAO,KAAK,KAAK,iBAAmB,SAAS,OAAO,CAAC;AACvD;AAGA,gBAAK,QAA0B,mBAAmB;AAAA,EAChD,OAAO;AAAA,EACP,SAAS,gBAAe;AAC1B,CAAC;AA5CL,IAAM,iBAAN;AAAA,CA+CC,MAAM;AACL,GAAC,OAAO,cAAc,eAAe,cAAiB,iBAAkB,gBAAgB,CAAC;AAAA,IACvF,MAAM;AAAA,EACR,CAAC,GAAG,MAAM,CAAC;AAAA,IACT,MAAM;AAAA,EACR,CAAC,GAAG,IAAI;AACV,GAAG;AACH,IAAM,uBAAN,MAAM,6BAA4B,eAAe;AAAA,EAC/C,cAAc;AACZ,UAAM,YAAY,eAAe,IAAI;AAAA,EACvC;AAaF;AAXI,qBAAK,OAAO,SAAS,4BAA4B,GAAG;AAClD,SAAO,KAAK,KAAK,sBAAqB;AACxC;AAGA,qBAAK,QAA0B,mBAAmB;AAAA,EAChD,OAAO;AAAA,EACP,SAAS,qBAAoB;AAAA,EAC7B,YAAY;AACd,CAAC;AAdL,IAAM,sBAAN;AAAA,CAiBC,MAAM;AACL,GAAC,OAAO,cAAc,eAAe,cAAiB,iBAAkB,qBAAqB,CAAC;AAAA,IAC5F,MAAM;AAAA,IACN,MAAM,CAAC;AAAA,MACL,YAAY;AAAA,IACd,CAAC;AAAA,EACH,CAAC,GAAG,MAAM,CAAC,GAAG,IAAI;AACpB,GAAG;AACH,IAAM,yBAAN,MAAM,+BAA8B,eAAe;AAAA,EACjD,cAAc;AACZ,UAAM,YAAY,iBAAiB,IAAI;AAAA,EACzC;AAaF;AAXI,uBAAK,OAAO,SAAS,8BAA8B,GAAG;AACpD,SAAO,KAAK,KAAK,wBAAuB;AAC1C;AAGA,uBAAK,QAA0B,mBAAmB;AAAA,EAChD,OAAO;AAAA,EACP,SAAS,uBAAsB;AAAA,EAC/B,YAAY;AACd,CAAC;AAdL,IAAM,wBAAN;AAAA,CAiBC,MAAM;AACL,GAAC,OAAO,cAAc,eAAe,cAAiB,iBAAkB,uBAAuB,CAAC;AAAA,IAC9F,MAAM;AAAA,IACN,MAAM,CAAC;AAAA,MACL,YAAY;AAAA,IACd,CAAC;AAAA,EACH,CAAC,GAAG,MAAM,CAAC,GAAG,IAAI;AACpB,GAAG;",
  "names": []
}
